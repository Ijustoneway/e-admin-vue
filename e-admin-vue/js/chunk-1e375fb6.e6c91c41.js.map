{"version":3,"sources":["webpack:///./src/mixins/pagination.js","webpack:///./src/mixins/index.js","webpack:///./src/api/resource.js","webpack:///./src/views/role/role.vue?5d10","webpack:///./src/views/role/components/edit.vue?be09","webpack:///src/views/role/components/edit.vue","webpack:///./src/views/role/components/edit.vue?868b","webpack:///./src/views/role/components/edit.vue","webpack:///src/views/role/role.vue","webpack:///./src/views/role/role.vue?6e89","webpack:///./src/views/role/role.vue","webpack:///./src/views/role/index.js","webpack:///./src/api/role.js","webpack:///./src/utils/index.js"],"names":["data","params","page","size","methods","handleSizeChange","this","query","handleCurrentChange","changeQuery","getResources","axios","method","url","getTotalResources","getDirs","createResource","updateResource","patchResource","deleteResource","id","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","on","nativeOn","$event","type","indexOf","_k","keyCode","key","model","value","callback","$$v","$set","expression","querying","_v","handleCreate","directives","name","rawName","list","handleSortChange","scopedSlots","_u","fn","ref","row","_s","_f","createdAt","updatedAt","handleEdit","handleDelete","pageSizes","paginationLayout","total","_e","staticRenderFns","title","visible","dialogModalClose","dialogEscClose","onClose","form","rules","resourceList","checkedKeys","children","label","slot","submiting","onSubmit","description","open","$nextTick","resources","filter","$refs","validate","resetFields","component","getRoles","getTotalRoles","createRole","updateRole","deleteRole","listToTree","parentKey","ret","temp","v","forEach","item","push"],"mappings":"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","file":"js/chunk-1e375fb6.e6c91c41.js","sourcesContent":["export default {\r\n  data() {\r\n    return {\r\n      params: {\r\n        page: 1,\r\n        size: 10\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    handleSizeChange(size) {\r\n      this.params.size = size\r\n      this.params.page = 1\r\n      this.query()\r\n    },\r\n    handleCurrentChange(page) {\r\n      this.params.page = page\r\n      this.query()\r\n    },\r\n    changeQuery() {\r\n      this.params.page = 1\r\n      this.params.size = 10\r\n      this.query()\r\n    }\r\n  }\r\n}\r\n","import pagination from './pagination'\r\n\r\nexport {\r\n  pagination\r\n}\r\n","import axios from '@/utils/axios'\r\n\r\nexport const getResources = params => {\r\n  return axios({\r\n    method: 'get',\r\n    url: '/resource',\r\n    params\r\n  })\r\n}\r\n\r\nexport const getTotalResources = params => {\r\n  return axios({\r\n    method: 'get',\r\n    url: '/resource/total',\r\n    params\r\n  })\r\n}\r\n\r\nexport const getDirs = params => {\r\n  return axios({\r\n    method: 'get',\r\n    url: '/resource/dir',\r\n    params\r\n  })\r\n}\r\n\r\nexport const createResource = params => {\r\n  return axios({\r\n    method: 'post',\r\n    url: '/resource',\r\n    data: params\r\n  })\r\n}\r\n\r\nexport const updateResource = params => {\r\n  return axios({\r\n    method: 'put',\r\n    url: '/resource',\r\n    data: params\r\n  })\r\n}\r\n\r\nexport const patchResource = params => {\r\n  return axios({\r\n    method: 'patch',\r\n    url: '/resource',\r\n    data: params\r\n  })\r\n}\r\n\r\nexport const deleteResource = params => {\r\n  return axios({\r\n    method: 'delete',\r\n    url: `/resource/${params.id}`,\r\n    params\r\n  })\r\n}\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('el-form',{staticClass:\"com-form media-form\",attrs:{\"label-width\":\"80px\",\"size\":\"small\"}},[_c('el-row',{attrs:{\"gutter\":20}},[_c('el-col',{attrs:{\"span\":6}},[_c('el-form-item',{attrs:{\"label\":\"角色名\"}},[_c('el-input',{attrs:{\"placeholder\":\"请输入角色名\",\"clearable\":\"\"},on:{\"clear\":_vm.changeQuery},nativeOn:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.changeQuery($event)}},model:{value:(_vm.params.name),callback:function ($$v) {_vm.$set(_vm.params, \"name\", $$v)},expression:\"params.name\"}})],1)],1),_c('el-col',{attrs:{\"span\":6}},[_c('el-form-item',{attrs:{\"label\":\"\",\"label-width\":\"0px\"}},[_c('el-button',{attrs:{\"type\":\"primary\",\"loading\":_vm.querying},on:{\"click\":_vm.changeQuery}},[_vm._v(\"查询\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.handleCreate}},[_vm._v(\"添加\")])],1)],1)],1)],1),_c('el-table',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.querying),expression:\"querying\"}],staticClass:\"com-table\",attrs:{\"data\":_vm.list},on:{\"sort-change\":_vm.handleSortChange}},[_c('el-table-column',{attrs:{\"align\":\"center\",\"prop\":\"name\",\"label\":\"角色名\"}}),_c('el-table-column',{attrs:{\"align\":\"center\",\"prop\":\"description\",\"label\":\"角色描述\"}}),_c('el-table-column',{attrs:{\"align\":\"center\",\"label\":\"添加时间\",\"prop\":\"createdAt\",\"sortable\":\"custom\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_vm._v(\"\\n        \"+_vm._s(_vm._f(\"formatDateTime\")(row.createdAt))+\"\\n      \")]}}])}),_c('el-table-column',{attrs:{\"align\":\"center\",\"label\":\"修改时间\",\"prop\":\"updatedAt\",\"sortable\":\"custom\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_vm._v(\"\\n        \"+_vm._s(_vm._f(\"formatDateTime\")(row.updatedAt))+\"\\n      \")]}}])}),_c('el-table-column',{attrs:{\"align\":\"center\",\"label\":\"操作\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [(row.name === '超级管理员')?[_vm._v(\"\\n          -\\n        \")]:[_c('el-button',{attrs:{\"type\":\"text\"},on:{\"click\":function($event){return _vm.handleEdit(row)}}},[_vm._v(\"\\n            编辑\\n          \")]),_c('el-button',{attrs:{\"type\":\"text\"},on:{\"click\":function($event){return _vm.handleDelete(row)}}},[_vm._v(\"\\n            删除\\n          \")])]]}}])})],1),(_vm.total)?_c('el-pagination',{staticClass:\"com-pagination\",attrs:{\"small\":\"\",\"background\":\"\",\"current-page\":_vm.params.page,\"page-size\":_vm.params.size,\"page-sizes\":_vm.pageSizes,\"layout\":_vm.paginationLayout,\"total\":_vm.total},on:{\"size-change\":_vm.handleSizeChange,\"current-change\":_vm.handleCurrentChange}}):_vm._e(),_c('edit',{ref:\"dialog\",on:{\"success\":_vm.query}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-dialog',{attrs:{\"title\":_vm.title,\"visible\":_vm.visible,\"width\":\"600px\",\"close-on-click-modal\":_vm.dialogModalClose,\"close-on-press-escape\":_vm.dialogEscClose},on:{\"close\":_vm.onClose}},[_c('el-form',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.querying),expression:\"querying\"}],ref:\"form\",staticClass:\"form\",attrs:{\"label-width\":\"96px\",\"model\":_vm.form,\"rules\":_vm.rules,\"size\":\"small\"}},[_c('el-form-item',{attrs:{\"label\":\"角色名: \",\"prop\":\"name\"}},[_c('el-input',{attrs:{\"placeholder\":\"请输入角色名\"},model:{value:(_vm.form.name),callback:function ($$v) {_vm.$set(_vm.form, \"name\", $$v)},expression:\"form.name\"}})],1),_c('el-form-item',{attrs:{\"label\":\"角色描述: \",\"prop\":\"description\"}},[_c('el-input',{attrs:{\"placeholder\":\"请输入角色描述\"},model:{value:(_vm.form.description),callback:function ($$v) {_vm.$set(_vm.form, \"description\", $$v)},expression:\"form.description\"}})],1),_c('el-form-item',{attrs:{\"label\":\"可用权限：\",\"prop\":\"remark\"}},[_c('el-tree',{ref:\"tree\",attrs:{\"data\":_vm.resourceList,\"show-checkbox\":\"\",\"default-checked-keys\":_vm.checkedKeys,\"node-key\":\"id\",\"props\":{\n            children: 'children',\n            label: 'name'\n          }}})],1)],1),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{attrs:{\"size\":\"small\"},on:{\"click\":_vm.onClose}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\",\"loading\":_vm.submiting},on:{\"click\":_vm.onSubmit}},[_vm._v(\"确 定\")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <el-dialog\r\n    :title=\"title\"\r\n    :visible=\"visible\"\r\n    width=\"600px\"\r\n    @close=\"onClose\"\r\n\t\t:close-on-click-modal=\"dialogModalClose\"\r\n    :close-on-press-escape=\"dialogEscClose\"\r\n  >\r\n    <el-form\r\n      class=\"form\"\r\n      ref=\"form\"\r\n      label-width=\"96px\"\r\n      :model=\"form\"\r\n      :rules=\"rules\"\r\n      size=\"small\"\r\n      v-loading=\"querying\">\r\n      <el-form-item label=\"角色名: \" prop=\"name\">\r\n        <el-input v-model=\"form.name\" placeholder=\"请输入角色名\" />\r\n      </el-form-item>\r\n      <el-form-item label=\"角色描述: \" prop=\"description\">\r\n        <el-input v-model=\"form.description\" placeholder=\"请输入角色描述\" />\r\n      </el-form-item>\r\n      <el-form-item label=\"可用权限：\" prop=\"remark\">\r\n\t\t\t\t<el-tree\r\n          ref=\"tree\"\r\n          :data=\"resourceList\"\r\n          show-checkbox\r\n          :default-checked-keys=\"checkedKeys\"\r\n          node-key=\"id\"\r\n          :props=\"{\r\n            children: 'children',\r\n            label: 'name'\r\n          }\">\r\n        </el-tree>\r\n\t\t\t</el-form-item>\r\n    </el-form>\r\n    <div slot=\"footer\" class=\"dialog-footer\">\r\n\t\t\t<el-button @click=\"onClose\" size=\"small\">取 消</el-button>\r\n\t\t\t<el-button type=\"primary\" size=\"small\" @click=\"onSubmit\" :loading=\"submiting\">确 定</el-button>\r\n\t\t</div>\r\n  </el-dialog>\r\n</template>\r\n\r\n<script>\r\nimport { createRole, updateRole } from '@/api/role'\r\nimport { getTotalResources } from '@/api/resource'\r\nimport { listToTree } from '@/utils'\r\nexport default {\r\n  data() {\r\n    return {\r\n      visible: false,\r\n      submiting: false,\r\n      querying: false,\r\n      title: '添加',\r\n      id: null,\r\n      form: {\r\n        name: '',\r\n        description: ''\r\n      },\r\n      resourceList: [],\r\n      checkedKeys: [],\r\n      rules: {\r\n        name: [\r\n          { required: true, message: '请输入权限名', trigger: 'blur' }\r\n        ],\r\n        description: [\r\n          { required: true, message: '请输入权限名', trigger: 'blur' }\r\n        ]\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    open(row) {\r\n      this.visible = true\r\n      this.title = row ? '编辑' : '添加'\r\n      this.query()\r\n      if (row) {\r\n        this.id = row.id\r\n        this.$nextTick(() => {\r\n          this.form = {\r\n            name: row.name,\r\n            description: row.description\r\n          }\r\n        })\r\n        this.checkedKeys = row.resources.filter(item => item.type === '2').map(v => v.id)\r\n      }\r\n    },\r\n    async query() {\r\n      try {\r\n        this.querying = true\r\n        const res = await getTotalResources()\r\n        if (res.success) {\r\n          const list = res.data || []\r\n          const result = listToTree(list, null, 'code', 'parentCode')\r\n          this.resourceList = result\r\n        }\r\n      } catch (err) {\r\n        console.log(err)\r\n      } finally {\r\n        this.querying = false\r\n      }\r\n    },\r\n    onSubmit() {\r\n      this.$refs.form.validate(async valid => {\r\n        if (valid) {\r\n          try {\r\n            this.submiting = true\r\n            let res = {}\r\n            const checkedNodes = this.$refs.tree.getCheckedNodes(false, false)\r\n            const checkedNodeKeys = checkedNodes.map(item => item.id)\r\n            const halfCheckedKeys = this.$refs.tree.getHalfCheckedKeys()\r\n            if (this.id) {\r\n              res = await updateRole({\r\n                ...this.form,\r\n                id: this.id,\r\n                resources: halfCheckedKeys.concat(checkedNodeKeys)\r\n              })\r\n            } else {\r\n              res = await createRole({\r\n                ...this.form,\r\n                resources: halfCheckedKeys.concat(checkedNodeKeys)\r\n              })\r\n            }\r\n            if (res.success) {\r\n              this.$message.closeAll()\r\n              this.$message.success(this.id ? '修改成功' : '添加成功')\r\n              this.visible = false\r\n              this.$emit('success')\r\n            }\r\n          } catch (err) {\r\n            console.log(err)\r\n          } finally {\r\n            this.submiting = false\r\n          }\r\n        }\r\n      })\r\n    },\r\n    onClose() {\r\n      this.visible = false\r\n      this.id = null\r\n      this.$refs.form.resetFields()\r\n      this.resourceList = []\r\n      this.checkedKeys = []\r\n    }\r\n  }\r\n}\r\n</script>\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./edit.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./edit.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./edit.vue?vue&type=template&id=80a7a8ba&\"\nimport script from \"./edit.vue?vue&type=script&lang=js&\"\nexport * from \"./edit.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div>\r\n    <el-form class=\"com-form media-form\" label-width=\"80px\" size=\"small\">\r\n      <el-row :gutter=\"20\">\r\n        <el-col :span=\"6\">\r\n          <el-form-item label=\"角色名\">\r\n            <el-input v-model=\"params.name\" placeholder=\"请输入角色名\" clearable @clear=\"changeQuery\" @keyup.enter.native=\"changeQuery\" />\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"6\">\r\n          <el-form-item label=\"\" label-width=\"0px\">\r\n            <el-button type=\"primary\" :loading=\"querying\" @click=\"changeQuery\">查询</el-button>\r\n            <el-button type=\"primary\" @click=\"handleCreate\">添加</el-button>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n    </el-form>\r\n    <el-table class=\"com-table\" :data=\"list\" v-loading=\"querying\" @sort-change=\"handleSortChange\">\r\n      <el-table-column align=\"center\" prop=\"name\" label=\"角色名\" />\r\n      <el-table-column align=\"center\" prop=\"description\" label=\"角色描述\" />\r\n      <el-table-column align=\"center\" label=\"添加时间\" prop=\"createdAt\" sortable=\"custom\">\r\n        <template slot-scope=\"{row}\">\r\n          {{row.createdAt | formatDateTime}}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column align=\"center\" label=\"修改时间\" prop=\"updatedAt\" sortable=\"custom\">\r\n        <template slot-scope=\"{row}\">\r\n          {{row.updatedAt | formatDateTime}}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column align=\"center\" label=\"操作\">\r\n        <template slot-scope=\"{row}\">\r\n          <template v-if=\"row.name === '超级管理员'\">\r\n            -\r\n          </template>\r\n          <template v-else>\r\n            <el-button type=\"text\" @click=\"handleEdit(row)\">\r\n              编辑\r\n            </el-button>\r\n            <el-button type=\"text\" @click=\"handleDelete(row)\">\r\n              删除\r\n            </el-button>\r\n          </template>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <el-pagination\r\n      v-if=\"total\"\r\n      class=\"com-pagination\"\r\n      small\r\n      background\r\n      @size-change=\"handleSizeChange\"\r\n      @current-change=\"handleCurrentChange\"\r\n      :current-page=\"params.page\"\r\n      :page-size=\"params.size\"\r\n      :page-sizes=\"pageSizes\"\r\n      :layout=\"paginationLayout\"\r\n      :total=\"total\">\r\n    </el-pagination>\r\n    <edit ref=\"dialog\" @success=\"query\" />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import {\r\n    getRoles,\r\n    deleteRole\r\n  } from '@/api/role'\r\n  import {\r\n    pagination\r\n  } from '@/mixins'\r\n  import Edit from './components/edit'\r\n  export default {\r\n    mixins: [pagination],\r\n    components: {\r\n      Edit\r\n    },\r\n    data() {\r\n      return {\r\n        querying: false,\r\n        list: [],\r\n        total: 0,\r\n        params: {\r\n          page: 1,\r\n          size: 10,\r\n          name: ''\r\n        }\r\n      }\r\n    },\r\n    mounted() {\r\n      this.query()\r\n    },\r\n    methods: {\r\n      async query() {\r\n        try {\r\n          this.querying = true\r\n          const res = await getRoles(this.params)\r\n          if (res.success) {\r\n            const data = res.data || {}\r\n            const list = data.list || []\r\n            const total = data.total || 0\r\n            this.list = list\r\n            this.total = total\r\n          }\r\n        } catch (err) {\r\n          console.log(err)\r\n        } finally {\r\n          this.querying = false\r\n        }\r\n      },\r\n      handleSortChange(sort) {\r\n        this.params.page = 1\r\n        this.params.size = 10\r\n        if (sort.prop && sort.order) {\r\n          this.params.sortProp = sort.prop\r\n          this.params.sortOrder = sort.order === 'ascending' ? 1 : -1\r\n        } else {\r\n          this.params.sortProp = null\r\n          this.params.sortOrder = null\r\n        }\r\n        this.query()\r\n      },\r\n      handleCreate() {\r\n        this.$refs.dialog.open()\r\n      },\r\n      handleEdit(row) {\r\n        this.$refs.dialog.open(row)\r\n      },\r\n      handleDelete(row) {\r\n        this.$confirm('确定要删除吗？', '温馨提示', {\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        }).then(async () => {\r\n          try {\r\n            const res = await deleteRole({\r\n              id: row.id\r\n            })\r\n            if (res.success) {\r\n              this.$message.closeAll()\r\n              this.$message.success('删除成功')\r\n              this.query()\r\n            }\r\n          } catch (err) {\r\n            console.log(err)\r\n          }\r\n        })\r\n      }\r\n    }\r\n  }\r\n\r\n</script>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./role.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./role.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./role.vue?vue&type=template&id=58c2326e&\"\nimport script from \"./role.vue?vue&type=script&lang=js&\"\nexport * from \"./role.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export { default } from './role'\r\n","import axios from '@/utils/axios'\r\n\r\nexport const getRoles = params => {\r\n  return axios({\r\n    method: 'get',\r\n    url: '/role',\r\n    params\r\n  })\r\n}\r\n\r\nexport const getTotalRoles = () => {\r\n  return axios({\r\n    method: 'get',\r\n    url: '/role/total'\r\n  })\r\n}\r\n\r\nexport const createRole = params => {\r\n  return axios({\r\n    method: 'post',\r\n    url: '/role',\r\n    data: params\r\n  })\r\n}\r\n\r\nexport const updateRole = params => {\r\n  return axios({\r\n    method: 'put',\r\n    url: '/role',\r\n    data: params\r\n  })\r\n}\r\n\r\nexport const deleteRole = params => {\r\n  return axios({\r\n    method: 'delete',\r\n    url: `/role/${params.id}`\r\n  })\r\n}\r\n","\r\nexport function listToTree(list, id, key, parentKey) {\r\n  const ret = []\r\n  const temp = list.filter(v => v[parentKey] === id)\r\n  temp.forEach(item => {\r\n    ret.push({\r\n      ...item,\r\n      children: listToTree(list, item[key], key, parentKey)\r\n    })\r\n  })\r\n  return ret\r\n}\r\n"],"sourceRoot":""}